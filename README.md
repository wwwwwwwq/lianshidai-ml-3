<font color="#87CEEB" size="5">ğŸ åšé¢˜ç¬”è®°</font>

### å†™åœ¨å‰é¢

<details>
<summary><strong>ğŸ“ å†™åœ¨å‰é¢</strong></summary>

---

æœ¬é¡¹ç›®å·²ç»å¼€æºåœ¨githubä»“åº“ï¼š  
```bash
https://github.com/wwwwwwwq/lianshidai-ml-3.git
```

---

æ–‡ä»¶å¤¹ä¸‹å„ä¸ª.pyæ–‡ä»¶è¯´æ˜ï¼š  
```bash
base.pyï¼šåŸºç¡€éƒ¨åˆ†ï¼ˆæ²¡æœ‰å¯¹æ•°è½¬æ¢å’ŒRæ–¹æ£€æµ‹ï¼Œä¸è¿‡åŒ…æ‹¬äº†å›¾è¡¨çš„ç»˜ç”»ï¼‰ï¼Œé»˜è®¤æ˜¯è¿›è¡Œsklearnæ¨¡å‹è®­ç»ƒ
base_mannual.pyï¼šæ‰‹åŠ¨å®ç°æœ€å°äºŒä¹˜æ³•å®ç°çº¿æ€§å›å½’ï¼ˆBuild it from scratchåº”è¯¥æ˜¯è¿™ä¸ªæ„æ€å§qwqï¼‰
base_sklearn.pyï¼šä½¿ç”¨sklearn.linear_model.LinearRegressionæ¥è®­ç»ƒæ¨¡å‹

extend.pyï¼šæ‹“å±•éƒ¨åˆ†ï¼Œå¢åŠ äº†Ræ–¹æ£€æµ‹å’Œå¯¹æ•°è½¬æ¢ï¼Œé»˜è®¤æ˜¯è¿›è¡Œsklearnæ¨¡å‹è®­ç»ƒ
extend_mannual.pyï¼šæ‰‹åŠ¨å®ç°æœ€å°äºŒä¹˜æ³•å®ç°çº¿æ€§å›å½’
extend_sklearn.pyï¼šä½¿ç”¨sklearn.linear_model.LinearRegressionæ¥è®­ç»ƒæ¨¡å‹
```
  
è¿è¡Œè¯´æ˜ï¼š  
```bash
python [base.py/extend.py] [1/2]
#[1/2]æ˜¯æŒ‡ï¼Œå¦‚æœè¾“å…¥1ï¼Œåˆ™æ˜¯sklearnï¼Œå¦‚æœè¾“å…¥2ï¼Œåˆ™æ˜¯mannual

å¦‚æœåœ¨æ–‡æœ¬ç¼–è¾‘å™¨é‡Œé¢è¿è¡Œï¼Œé‚£ä¹ˆå¯¹åº”åŠŸèƒ½å¦‚ä¸Š .pyæ–‡ä»¶è¯´æ˜ æ‰€è¿°
```
  
éœ€è¦çš„åŒ…ï¼š
```bash
pandas,numpy,matplotlib,Scikit-Learn
```

---

**æ³¨ï¼š**
åœ¨æ­¤åªå¯¹åŸºç¡€éƒ¨åˆ†åšè®²è§£ï¼Œæ‹“å±•éƒ¨åˆ†åªç»™å‡ºå®Œæ•´ä»£ç 
</details>

### é¢˜æ„ç†è§£

<details>
<summary><strong>ğŸ¯ é¢˜æ„ç†è§£</strong></summary>

---

å¤§æ¦‚å°±æ˜¯è¯´ï¼Œä»NASA ç³»å¤–è¡Œæ˜Ÿæ•°æ®åº“çš„æ•°æ®ï¼ˆå·²æ”¾åœ¨exoplanet_data.csvä¸­ï¼‰è¯»å–**è½¨é“åŠé•¿è½´(pl_orbsmax)**
å’Œ**æ¯æ’æ˜Ÿè´¨é‡(st_mass)**ï¼Œè¿™ä¸¤ä¸ªå˜é‡ä½œä¸ºè¾“å…¥ç‰¹å¾ï¼Œ**è½¨é“å‘¨æœŸ(pl_orbper)** ä½œä¸ºç›®æ ‡å˜é‡ï¼Œ
æ¥æ„å»ºçº¿æ€§å›å½’æ¨¡å‹ã€‚å¹¶ä¸”è¦ç”¨**å‡æ–¹è¯¯å·®(MSE)** æ¥è¯„ä¼°æ¨¡å‹çš„æ€§èƒ½ã€‚ç„¶åçš„è¯è¿˜æœ‰ä¸€ä¸ª**æ‰‹åŠ¨ä½¿ç”¨æœ€å°äºŒä¹˜æ³•å®ç°çº¿æ€§å›å½’**çš„ä»»åŠ¡
</details>

### è¾“å…¥è¾“å‡º

<details>
<summary><strong>ğŸ§© è¾“å…¥</strong></summary>

---

**NASA ç³»å¤–è¡Œæ˜Ÿæ•°æ®åº“çš„csvæ–‡ä»¶**(exoplanet_data.csv)
</details>

<details>
<summary><strong>ğŸ“± è¾“å‡º</strong></summary>

---

**å¯è§†åŒ–æ•£ç‚¹å›¾**ï¼Œ**é¢„æµ‹ç†æƒ³çº¿**ï¼Œ**è§£é‡Šæ¨¡å‹çš„è¯¯å·®**
</details>

### è§£å†³é¢˜ç›®

<details>
<summary><strong>ğŸ“¥ è¯»å…¥æ•°æ®</strong></summary>

---

ç”±äºæ¥å—çš„æ˜¯.csvæ–‡ä»¶çš„æ•°æ®ï¼Œè¿™é‡Œä¸ºäº†æ–¹ä¾¿å°±ç›´æ¥ç”¨pandasçš„read_csvæ¥è¯»å…¥æ•°æ®äº†
ä¸è¿‡è¦æ³¨æ„çš„æ˜¯ä¸‹è½½ä¸‹æ¥çš„exoplanet_data.csvæ–‡ä»¶ä¸­çš„å†…å®¹æ˜¯ä»¥#å¼€å¤´çš„ï¼š  
```bash
# This file was produced by the NASA Exoplanet Archive  http://exoplanetarchive.ipac.caltech.edu
# Wed Feb 19 21:07:49 2025
#
# COLUMN pl_name:        Planet Name
# COLUMN hostname:       Host Name
# COLUMN sy_snum:        Number of Stars
# COLUMN sy_pnum:        Number of Planets
#...
```
æ‰€ä»¥è¯´æˆ‘ä»¬éœ€è¦è·³è¿‡è¿™ä¸€éƒ¨åˆ†ï¼Œå°±åœ¨read_csvä¸­æ·»åŠ ä¸€ä¸ª **'comment='#''** çš„å‚æ•°ï¼š  
```bash
    #ä»expolanet_data.csvæ–‡ä»¶ï¼ˆå½“å‰ç›®å½•ï¼‰ä¸­è¯»å–æ•°æ®
    #ç”±äºè¯»å–çš„æ˜¯DataFrameç±»å‹ï¼Œæ‰€ä»¥è¿™é‡Œç”¨dfç¼©å†™è¡¨ç¤ºè¯»å–çš„æ•°æ®
    #ç”¨pandasåº“æ¥è¯»å–csvæ–‡ä»¶ï¼ˆè¿™é‡Œç®€å†™ä¸ºpdï¼‰
    df=pd.read_csv('exoplanet_data.csv',comment='#')
```
ç„¶åå°±è¯»å–è¾“å…¥å˜é‡å’Œç›®æ ‡å˜é‡ï¼š  
```python
#è‡ªå˜é‡ï¼ˆè¾“å…¥å˜é‡ï¼‰xï¼Œå…¶å€¼ä¸ºè½¨é“åŠé•¿è½´aå’Œæ’æ˜ŸæŒ‡ä»¤m
    x=df[['pl_orbsmax','st_mass']]

    #å› å˜é‡ï¼ˆè¾“å‡ºå˜é‡ï¼‰yï¼Œå…¶å€¼ä¸ºè½¨é“å‘¨æœŸ
    y=df['pl_orbper']
```
æ¥ä¸‹æ¥è¦å¤„ç†ç¼ºå¤±å€¼ï¼ˆNaNæˆ–è€…nullï¼‰ï¼Œå› ä¸ºçº¿æ€§å›å½’ç®—æ³•ä¸èƒ½å¤„ç†ç¼ºå¤±å€¼ã€‚å…·ä½“çš„ä¾‹å­å’Œç”¨åˆ°çš„å‡½æ•°å¯ä»¥è¯¦è§ä»£ç çš„æ³¨é‡Šï¼š  
```python
    #åˆ é™¤ç¼ºå¤±å€¼ã€‚
    #å› ä¸ºçº¿æ€§å›å½’ç®—æ³•ä¸èƒ½å¤„ç†ç¼ºå¤±å€¼ï¼ˆNaNå’Œnullï¼‰ï¼Œæ‰€ä»¥è¦æ‰‹åŠ¨å¤„ç†ç¼ºå¤±å€¼ï¼Œé˜²æ­¢æ•°æ®ä¸­æœ‰ç¼ºå¤±å€¼å‡ºç°ã€‚
    
    data=pd.concat([x,y],axis=1)#pandasçš„è¿æ¥å‡½æ•°ï¼Œaxis=1è¡¨ç¤ºæ°´å¹³è¿æ¥ï¼Œæ‰€ä»¥è¿™é‡Œå°†xå’Œyæ°´å¹³è¿æ¥èµ·æ¥
    #ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚ï¼š
    """
    åŸå§‹æ•°æ®ï¼š
    x:
       pl_orbsmax  st_mass
    0    1.0        2.0
    1    2.0        NaN#ç¼ºå¤±å€¼
    2    3.0        3.0
    3    4.0        4.0

    y:
    0    10.0
    1    20.0
    2    NaN#ç¼ºå¤±å€¼
    3    40.0

    è¿æ¥åï¼š
       pl_orbsmax  st_mass  pl_orbper
    0    1.0        2.0      10.0
    1    2.0        NaN      20.0    # æœ‰ç¼ºå¤±å€¼
    2    3.0        3.0      NaN     # æœ‰ç¼ºå¤±å€¼
    3    4.0        4.0      40.0
    """

    data=data.dropna()#åˆ é™¤åŒ…å«ç¼ºå¤±å€¼çš„è¡Œ
    #åˆ é™¤ç¼ºå¤±å€¼åï¼Œæ•°æ®å¦‚ä¸‹ï¼š
    """
    pl_orbsmax  st_mass  pl_orbper
    0    1.0        2.0      10.0
    3    4.0        4.0      40.0
    """

    #æ¥ä¸‹æ¥å°±æ˜¯ä»åˆ é™¤åçš„æ•°æ®ä¸­æå–è‡ªå˜é‡xå’Œå› å˜é‡y
    x=data[['pl_orbsmax','st_mass']]
    y=data['pl_orbper']

    #é‚£ä¹ˆå¤„ç†åxå’Œyå°±å˜æˆäº†ï¼š
    """
    x:
   pl_orbsmax  st_mass
    0    1.0        2.0
    3    4.0        4.0

    y:
    0    10.0
    3    40.0
    """
```
æ‰€ä»¥è¿™æ ·äº†ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å†™å‡ºåŠ è½½å’Œé¢„å¤„ç†å‡½æ•° **load_process_data** äº†ï¼š  
```python
#åŠ è½½å’Œé¢„å¤„ç†æ•°æ®å‡½æ•°
def load_process_data():
    #ä»expolanet_data.csvæ–‡ä»¶ï¼ˆå½“å‰ç›®å½•ï¼‰ä¸­è¯»å–æ•°æ®
    #ç”±äºè¯»å–çš„æ˜¯DataFrameç±»å‹ï¼Œæ‰€ä»¥è¿™é‡Œç”¨dfç¼©å†™è¡¨ç¤ºè¯»å–çš„æ•°æ®
    #ç”¨pandasåº“æ¥è¯»å–csvæ–‡ä»¶ï¼ˆè¿™é‡Œç®€å†™ä¸ºpdï¼‰
    df=pd.read_csv('exoplanet_data.csv',comment='#')

    #è‡ªå˜é‡ï¼ˆè¾“å…¥å˜é‡ï¼‰xï¼Œå…¶å€¼ä¸ºè½¨é“åŠé•¿è½´aå’Œæ’æ˜ŸæŒ‡ä»¤m
    x=df[['pl_orbsmax','st_mass']]

    #å› å˜é‡ï¼ˆè¾“å‡ºå˜é‡ï¼‰yï¼Œå…¶å€¼ä¸ºè½¨é“å‘¨æœŸ
    y=df['pl_orbper']

    #åˆ é™¤ç¼ºå¤±å€¼ã€‚
    #å› ä¸ºçº¿æ€§å›å½’ç®—æ³•ä¸èƒ½å¤„ç†ç¼ºå¤±å€¼ï¼ˆNaNå’Œnullï¼‰ï¼Œæ‰€ä»¥è¦æ‰‹åŠ¨å¤„ç†ç¼ºå¤±å€¼ï¼Œé˜²æ­¢æ•°æ®ä¸­æœ‰ç¼ºå¤±å€¼å‡ºç°ã€‚
    
    data=pd.concat([x,y],axis=1)#pandasçš„è¿æ¥å‡½æ•°ï¼Œaxis=1è¡¨ç¤ºæ°´å¹³è¿æ¥ï¼Œæ‰€ä»¥è¿™é‡Œå°†xå’Œyæ°´å¹³è¿æ¥èµ·æ¥
    #ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚ï¼š
    """
    åŸå§‹æ•°æ®ï¼š
    x:
       pl_orbsmax  st_mass
    0    1.0        2.0
    1    2.0        NaN#ç¼ºå¤±å€¼
    2    3.0        3.0
    3    4.0        4.0

    y:
    0    10.0
    1    20.0
    2    NaN#ç¼ºå¤±å€¼
    3    40.0

    è¿æ¥åï¼š
       pl_orbsmax  st_mass  pl_orbper
    0    1.0        2.0      10.0
    1    2.0        NaN      20.0    # æœ‰ç¼ºå¤±å€¼
    2    3.0        3.0      NaN     # æœ‰ç¼ºå¤±å€¼
    3    4.0        4.0      40.0
    """

    data=data.dropna()#åˆ é™¤åŒ…å«ç¼ºå¤±å€¼çš„è¡Œ
    #åˆ é™¤ç¼ºå¤±å€¼åï¼Œæ•°æ®å¦‚ä¸‹ï¼š
    """
    pl_orbsmax  st_mass  pl_orbper
    0    1.0        2.0      10.0
    3    4.0        4.0      40.0
    """

    #æ¥ä¸‹æ¥å°±æ˜¯ä»åˆ é™¤åçš„æ•°æ®ä¸­æå–è‡ªå˜é‡xå’Œå› å˜é‡y
    x=data[['pl_orbsmax','st_mass']]
    y=data['pl_orbper']

    #é‚£ä¹ˆå¤„ç†åxå’Œyå°±å˜æˆäº†ï¼š
    """
    x:
   pl_orbsmax  st_mass
    0    1.0        2.0
    3    4.0        4.0

    y:
    0    10.0
    3    40.0
    """

    #è¿”å›å¤„ç†åçš„è‡ªå˜é‡xå’Œå› å˜é‡y
    return x,y
```
</details>

<details>
<summary><strong>ğŸ–¥ï¸ åˆ©ç”¨sklearnè®­ç»ƒæ¨¡å‹</strong></summary>

---

å¾—åˆ°è½½å…¥å’Œé¢„å¤„ç†åçš„å˜é‡ä»¥åï¼Œå°±å¯ä»¥è®­ç»ƒæ¨¡å‹äº†ã€‚é‚£ä¹ˆè¿™é‡Œå…ˆç”¨**sklearn**è®­ç»ƒæ¨¡å‹ã€‚
é¦–å…ˆåˆ©ç”¨ **train_test_split** å‡½æ•°æ¥åˆ†ç¦»æµ‹è¯•æ•°æ®å’Œè®­ç»ƒæ•°æ®ï¼š  
```python
    #å°†æ•°æ®é›†åˆ’åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†

    #test_sizeè¡¨ç¤ºæœ‰å¤šå°‘çš„æ•°æ®ç”¨æ¥æµ‹è¯•ï¼Œrandom_state=42è¡¨ç¤ºéšæœºç§å­ä¸º42ã€‚éšæœºç§å­çš„è®¾ç½®æ˜¯ä¸ºäº†æ¯æ¬¡è¿è¡Œä»£ç æ—¶ï¼Œåˆ’åˆ†ç»“æœéƒ½ç›¸åŒã€‚
    #è¿™é‡Œé€‰æ‹©éšæœºç§å­ä¸º42æ˜¯å› ä¸º42æ˜¯å®‡å®™çš„ç»ˆæå¥¥ç§˜ï¼ˆï¼‰ã€‚
    x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=test_size,random_state=42)
```
æ¥ç€ï¼Œåˆ©ç”¨LinearRegressionç±»æ¥è®­ç»ƒæ¨¡å‹ï¼š  
```python
    #åˆ›å»ºå¹¶è®­ç»ƒçº¿æ€§å›å½’æ¨¡å‹

    #è¿™é‡Œåˆ©ç”¨scikit-learnåº“ä¸­çš„LinearRegressionç±»æ¥åˆ›å»ºçº¿æ€§å›å½’æ¨¡å‹ï¼Œå…¶ä¸­modelå°±æ˜¯LinearRegressionç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚
    #LinearRegressionç±»æ˜¯scikit-learnåº“ä¸­çš„ä¸€ä¸ªçº¿æ€§å›å½’ç±»ï¼Œç”¨äºæ„å»ºç±»ä¼¼äºy=ax_{1}+bx_{2}+cçš„æ–¹ç¨‹ã€‚å…¶ä¸­yä»£è¡¨æˆ‘ä»¬è¦é¢„æµ‹çš„è½¨é“å‘¨æœŸï¼Œx_{1}ä»£è¡¨è½¨é“åŠé•¿è½´ï¼Œx_{2}ä»£è¡¨æ’æ˜Ÿè´¨é‡ã€‚
    model=LinearRegression()

    #åˆ©ç”¨LinearRegressionç±»ä¸­çš„fitæ–¹æ³•è®­ç»ƒæ¨¡å‹
    model.fit(x_train,y_train)
```
ç„¶åè®­ç»ƒå®Œäº†ä¹‹åå°±æ‹¿åˆ°é¢„æµ‹å€¼å’Œmseï¼š  
```python
    #ç”¨LinearRegressionç±»ä¸­çš„predictæ–¹æ³•è¿›è¡Œé¢„æµ‹
    y_pred=model.predict(x_test)

    #åˆ©ç”¨mean_squared_errorå‡½æ•°è®¡ç®—å‡æ–¹è¯¯å·®
    mse=mean_squared_error(y_test,y_pred)
```
åšå®Œè¿™äº›ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°è®­ç»ƒå’Œæµ‹è¯•æ¨¡å‹çš„å‡½æ•°**train_test_model**äº†ï¼š  
```python
#è®­ç»ƒå’Œæµ‹è¯•æ¨¡å‹å‡½æ•°
def train_test_model(x,y,test_size=0.7):
    #å°†æ•°æ®é›†åˆ’åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†

    #test_sizeè¡¨ç¤ºæœ‰å¤šå°‘çš„æ•°æ®ç”¨æ¥æµ‹è¯•ï¼Œrandom_state=42è¡¨ç¤ºéšæœºç§å­ä¸º42ã€‚éšæœºç§å­çš„è®¾ç½®æ˜¯ä¸ºäº†æ¯æ¬¡è¿è¡Œä»£ç æ—¶ï¼Œåˆ’åˆ†ç»“æœéƒ½ç›¸åŒã€‚
    #è¿™é‡Œé€‰æ‹©éšæœºç§å­ä¸º42æ˜¯å› ä¸º42æ˜¯å®‡å®™çš„ç»ˆæå¥¥ç§˜ï¼ˆï¼‰ã€‚
    x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=test_size,random_state=42)

    #åˆ›å»ºå¹¶è®­ç»ƒçº¿æ€§å›å½’æ¨¡å‹

    #è¿™é‡Œåˆ©ç”¨scikit-learnåº“ä¸­çš„LinearRegressionç±»æ¥åˆ›å»ºçº¿æ€§å›å½’æ¨¡å‹ï¼Œå…¶ä¸­modelå°±æ˜¯LinearRegressionç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚
    #LinearRegressionç±»æ˜¯scikit-learnåº“ä¸­çš„ä¸€ä¸ªçº¿æ€§å›å½’ç±»ï¼Œç”¨äºæ„å»ºç±»ä¼¼äºy=ax_{1}+bx_{2}+cçš„æ–¹ç¨‹ã€‚å…¶ä¸­yä»£è¡¨æˆ‘ä»¬è¦é¢„æµ‹çš„è½¨é“å‘¨æœŸï¼Œx_{1}ä»£è¡¨è½¨é“åŠé•¿è½´ï¼Œx_{2}ä»£è¡¨æ’æ˜Ÿè´¨é‡ã€‚
    model=LinearRegression()

    #åˆ©ç”¨LinearRegressionç±»ä¸­çš„fitæ–¹æ³•è®­ç»ƒæ¨¡å‹
    model.fit(x_train,y_train)

    #ç”¨LinearRegressionç±»ä¸­çš„predictæ–¹æ³•è¿›è¡Œé¢„æµ‹
    y_pred=model.predict(x_test)

    #åˆ©ç”¨mean_squared_errorå‡½æ•°è®¡ç®—å‡æ–¹è¯¯å·®
    mse=mean_squared_error(y_test,y_pred)

    #è¿”å›model,mse,y_test,y_pred
    return model,mse,y_test,y_pred
```
</details>

<details>
<summary><strong>ğŸ” æ‰‹åŠ¨ä½¿ç”¨æœ€å°äºŒä¹˜æ³•æ¥å®Œæˆçº¿æ€§å›å½’ä»»åŠ¡</strong></summary>

---

ç”±äºé¢˜ç›®è¿˜è¯´è¦**æ‰‹åŠ¨ä½¿ç”¨æœ€å°äºŒä¹˜æ³•æ¥å®Œæˆçº¿æ€§å›å½’ä»»åŠ¡**ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦ç”¨ç¨‹åºæ¥å®ç°**æœ€å°äºŒä¹˜æ³•**ã€‚

- **æœ€å°äºŒä¹˜æ³•**  
    å‡è®¾**çº¿æ€§å›å½’æ–¹ç¨‹**ä¸ºï¼š  
    $$
    y=X*{\beta} + {\varepsilon}
    $$
    æˆ‘ä»¬çŸ¥é“å¦‚æœè¦**è¡¡é‡çº¿æ€§å›å½’æ¨¡å‹æ˜¯å¦æœ‰æ•ˆ**ï¼Œå¯ä»¥åˆ©ç”¨**æ®‹å·®å¹³æ–¹å’Œ**æ¥è¡¡é‡ï¼š  
    $$
    l=\sum_{i=1}^n {\varepsilon_{i}}^2=(y-X*{\beta})^T(y-X*{\beta})=(y^T-{\beta}^T*X^T)(y-X*{\beta})=y^Ty-y^TX{\beta}-{\beta}^TX^Ty+{\beta}^TX^TX{\beta}  
    $$
    $$
    è€Œç”±äº{\beta}^TX^Ty=(X{\beta})^Tyä¸­(X{\beta})^Tæ˜¯è¡Œå‘é‡ï¼Œyæ˜¯åˆ—å‘é‡ï¼Œæ‰€ä»¥{\beta}^TX^Ty=({\beta}^TX^Ty)^T=y^TX{\beta}  
    $$
    $æ‰€ä»¥æˆ‘ä»¬æœ‰ï¼š$
    $$
    l=y^Ty-2{\beta}^TX^Ty+{\beta}^TX^TX{\beta}
    $$
    è€Œæˆ‘ä»¬è¦ä½¿å¾—**æ®‹å·®å¹³æ–¹å’Œ**æœ€å°ï¼Œå¯ä»¥å¯¹å…¶è¿›è¡Œæ±‚å¯¼ï¼Œç„¶åå¾—åˆ°ä½¿å¾—å…¶æœ€å°çš„è§£ï¼š  
    $$
    \frac{\partial l}{\partial {\beta}}=-2X^Ty+2X^TX{\beta}
    $$
    $ä»¤å…¶ç­‰äº0ï¼š$
    $$
    -2X^Ty+2X^TX{\beta}=0
    $$
    $å¯ä»¥å¾—åˆ°ï¼š$
    $$
    {\beta}=(X^TX)^{-1}X^Ty
    $$
    äºæ˜¯è¿™å°±æ˜¯**æœ€ç»ˆçš„è§£æè§£**ã€‚  
    é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å°±ç”¨ç¨‹åºå®ç°å°±å¥½äº†ã€‚ä»¥ä¸‹æ˜¯**æ‰‹åŠ¨ä½¿ç”¨æœ€å°äºŒä¹˜æ³•å®Œæˆçº¿æ€§å›å½’ä»»åŠ¡**çš„å‡½æ•°ï¼š  
    ```python
    #æ‰‹åŠ¨å®ç°æœ€å°äºŒä¹˜æ³•å®ç°çº¿æ€§å›å½’ï¼ˆBuild it from scratchåº”è¯¥æ˜¯è¿™ä¸ªæ„æ€å§ï¼ˆï¼‰ï¼‰
    def mannual_linear_regression(x,y,test_size=0.7):
        #å°†æ•°æ®é›†åˆ’åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†
        x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=test_size, random_state=42)
    
        #æ·»åŠ åç½®é¡¹ï¼ˆä¹Ÿå°±æ˜¯æˆªè·é¡¹ï¼‰ï¼ŒæŠŠçŸ©é˜µxçš„æœ€å·¦è¾¹é‚£ä¸€è¡Œå…¨éƒ¨å˜æˆ1ï¼Œä»¥ä¾¿äºå‡ºç°å¸¸æ•°é¡¹
        #æ¯”å¦‚ï¼š
        """
        åŸå§‹æ•°æ®ï¼š
        x:
        |2 3|
        |4 5|
        æ ·æœ¬ï¼š
        x1=2,x2=3
        x1=4,x2=5
    
        æ·»åŠ åç½®é¡¹åï¼š
        x:
        |1 2 3|
        |1 4 5|
    
        å°±ä¼šæ˜¯ï¼š
        result:
        |1xc 2xÎ²1 3xÎ²2|
        |1xc 4xÎ²1 5xÎ²2|
        """
        #æ·»åŠ åç½®é¡¹
        x_train_b=np.c_[np.ones(x_train.shape[0]),x_train]
    
        #è®¡ç®—æœ€å°äºŒä¹˜æ³•çš„è§£æè§£ï¼šÎ²=(X^T*X)^-1*X^T*y
        results=np.linalg.inv(x_train_b.T.dot(x_train_b)).dot(x_train_b.T).dot(y_train)
    
        #è®¡ç®—æµ‹è¯•é›†çš„é¢„æµ‹å€¼
        x_test_b=np.c_[np.ones(x_test.shape[0]),x_test]
        y_pred=x_test_b.dot(results)
    
        #è®¡ç®—å‡æ–¹è¯¯å·®
        mse=mean_squared_error(y_test,y_pred)
    
        #è¿”å›ç»“æœ
        #results[0]æ˜¯æˆªè·é¡¹ï¼Œresults[1:]æ˜¯ç³»æ•°é¡¹
        return results[0],results[1:],y_test,y_pred,mse
    ```
</details>

<details>
<summary><strong>ğŸ“Š å¯è§†åŒ–ç»“æœ</strong></summary>

---

å½“å¤„ç†å®Œæ•°æ®ï¼Œè®­ç»ƒå¥½æ¨¡å‹ä»¥åï¼Œè¿™é‡Œæˆ‘ç”¨**matplotlibåº“**æ¥å¯è§†åŒ–ç»“æœã€‚  
é‚£ä¹ˆä¸ºäº†æ›´å¥½çš„å¯è§†åŒ–ï¼Œè¿™é‡Œæˆ‘ç”¨äº†ä¸€ä¸ª**æ»‘åŠ¨æ¡slider**æ¥æ§åˆ¶test_sizeï¼Œçœ‹çœ‹ä¸åŒçš„æµ‹è¯•æ•°æ®å æ¯”ä¼šå¯¼è‡´ç»“æœæ€ä¹ˆå˜åŒ–ã€‚ä¸è¿‡è¦æ³¨æ„çš„æ˜¯æ›´æ–°å›¾è¡¨ï¼Œæ‰€ä»¥éœ€è¦**sliderè®¢é˜…ä¸€ä¸ªupdateå‡½æ•°**ã€‚
ç”±äºåœ¨ä»£ç æ³¨é‡Šé‡Œå·²ç»å¾ˆè¯¦ç»†äº†ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥ç»™å‡º**visualize_results**çš„å®Œæ•´ä»£ç ï¼š  
```python
#åˆ©ç”¨pltå¯è§†åŒ–é¢„æµ‹ç»“æœ
def visualize_results(x,y,mode=1):
    #åˆ›å»ºå›¾å½¢çª—å£ï¼Œå¹¶å°†å¤§å°è®¾ç½®ä¸º10x6è‹±å¯¸
    fig=plt.figure(figsize=(10,6))

    #åˆ›å»ºGridSpecå¯¹è±¡ï¼Œç”¨äºæ§åˆ¶å­å›¾çš„å¸ƒå±€
    #2,1è¡¨ç¤ºåˆ›å»ºä¸€ä¸ª2è¡Œ1åˆ—çš„å­å›¾
    #height_ratios=[1,4]è¡¨ç¤ºç¬¬ä¸€è¡Œçš„é«˜åº¦ä¸º1ï¼Œç¬¬äºŒè¡Œçš„é«˜åº¦ä¸º4
    #hspace=0.2è¡¨ç¤ºå­å›¾ä¹‹é—´çš„å‚ç›´é—´è·ä¸º0.2
    gs=fig.add_gridspec(2,1,height_ratios=[1,4],hspace=0.2)

    #åœ¨ç½‘æ ¼çš„ç¬¬ä¸€è¡Œåˆ›å»ºä¸€ä¸ªå­å›¾ï¼Œç”¨äºæ˜¾ç¤ºçº¿æ€§å›å½’æ–¹ç¨‹ï¼Œè¯„ä¼°æŒ‡æ ‡
    #gs[0]è¡¨ç¤ºç½‘æ ¼çš„ç¬¬ä¸€è¡Œ
    ax_text=fig.add_subplot(gs[0])

    #åœ¨ç½‘æ ¼çš„ç¬¬äºŒè¡Œåˆ›å»ºä¸€ä¸ªæ•£ç‚¹å›¾å­å›¾
    #gs[1]è¡¨ç¤ºç½‘æ ¼çš„ç¬¬äºŒè¡Œ
    ax_scatter=fig.add_subplot(gs[1])

    #è°ƒæ•´å­å›¾å¸ƒå±€ï¼Œåœ¨åº•éƒ¨ç•™å‡º0.2çš„ç©ºç™½åŒºåŸŸæ”¾ç½®æ»‘åŠ¨æ¡
    plt.subplots_adjust(bottom=0.2)
    
    if mode==1:
        #è·å–train_test_modelçš„è¿”å›å€¼
        model,mse,y_test,y_pred=train_test_model(x,y,test_size=0.7)

        #è·å–çº¿æ€§å›å½’æ–¹ç¨‹çš„æ–‡æœ¬
        equ=f'pl_order = {model.coef_[0]:.3f} * pl_orbsmax + {model.coef_[1]:.3f} * st_mass + {model.intercept_:.3f}'
    elif mode==2:
        #è·å–mannual_linear_regressionçš„è¿”å›å€¼
        intercept,coef,y_test,y_pred,mse=mannual_linear_regression(x,y,test_size=0.7)

        #è·å–çº¿æ€§å›å½’æ–¹ç¨‹çš„æ–‡æœ¬
        equ=f'pl_order = {coef[0]:.3f} * pl_orbsmax + {coef[1]:.3f} * st_mass + {intercept:.3f}'

    #è·å–MSEæ–‡æœ¬
    mse_text=f'å‡æ–¹è¯¯å·®ï¼ˆ$MSE$ï¼‰ï¼š{mse:.3f}'

    #plt.scatter()æ¥ç»˜åˆ¶æ•£ç‚¹å›¾ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯xè½´ï¼ˆè¡¨ç¤ºçœŸå®å€¼ï¼‰ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯yè½´ï¼ˆè¡¨ç¤ºé¢„æµ‹å€¼ï¼‰ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯é€æ˜åº¦
    scatter=ax_scatter.scatter(y_test,y_pred,alpha=0.5,label='pred vs. true')

    #è·å–åæ ‡è½´çš„æœ€å°å€¼å’Œæœ€å¤§å€¼
    ax_min=min(y_test.min(),y_pred.min())
    ax_max=max(y_test.max(),y_pred.max())

    #ç»˜åˆ¶ç†æƒ³çš„é¢„æµ‹çº¿ï¼ˆidealï¼‰ï¼Œä¹Ÿå°±æ˜¯å¯¹è§’çº¿
    #[y_test.min(),y_test.max()]ï¼šxè½´çš„èµ·ç‚¹å’Œç»ˆç‚¹
    #[y_test.min(),y_test.max()]ï¼šyè½´çš„èµ·ç‚¹å’Œç»ˆç‚¹
    #'r--'ï¼šçº¢è‰²è™šçº¿ï¼ˆrä»£è¡¨redçº¢è‰²ï¼Œ--ä»£è¡¨è™šçº¿ï¼‰
    #lw=2ï¼šçº¿å®½ä¸º2
    line,=ax_scatter.plot([ax_min,ax_max],[ax_min,ax_max],'r--',lw=2,label='ideal')

    #è®¾ç½®æ•£ç‚¹å›¾çš„åæ ‡è½´èŒƒå›´ï¼Œä½¿ä¹‹å˜æˆä¸€ä¸ªæ­£æ–¹å½¢
    ax_scatter.set_xlim(ax_min,ax_max)
    ax_scatter.set_ylim(ax_min,ax_max)
    #è®¾ç½®æ•£ç‚¹å›¾çš„åæ ‡è½´æ¯”ä¾‹
    ax_scatter.set_aspect('equal',adjustable='box')
        
    #åˆ›å»ºä¸€ä¸ªæ»‘åŠ¨æ¡ï¼Œç”¨äºæ§åˆ¶æµ‹è¯•é›†çš„æ¯”ä¾‹test_size
    #0.2ï¼šæ»‘åŠ¨æ¡çš„xè½´
    #0.1ï¼šæ»‘åŠ¨æ¡çš„yè½´
    #0.6ï¼šæ»‘åŠ¨æ¡çš„å®½åº¦
    #0.03ï¼šæ»‘åŠ¨æ¡çš„é«˜åº¦
    ax_slider=plt.axes([0.2,0.1,0.6,0.03])
    #åˆ›å»ºä¸€ä¸ªè°ƒèŠ‚èŒƒå›´ä¸º0-1çš„æ»‘åŠ¨æ¡ï¼Œå¹¶ä¸”åˆå§‹å€¼ä¸º0.7
    slider=Slider(ax_slider,'Test Size',0,1,valinit=0.7)

    #æ–‡æœ¬ä¿¡æ¯å…³é—­åæ ‡è½´
    ax_text.axis('off')    

    #æ·»åŠ åˆ°ax_textä¸­
    #0.05ä»£è¡¨æ–‡æœ¬æ¡†å·¦ä¸Šè§’çš„xåæ ‡
    #0.5ä»£è¡¨æ–‡æœ¬æ¡†å·¦ä¸Šè§’çš„yåæ ‡
    #transformæŒ‡å®šåæ ‡ç³»æ˜¯transAxes(ç›¸å¯¹åæ ‡ç³»)ï¼Œåæ ‡èŒƒå›´ä¸º[0,1]
    #verticalalignment='center'è¡¨ç¤ºæ–‡æœ¬å‚ç›´å±…ä¸­äº(0.05,0.5)
    #bbox=dict()è®¾ç½®æ–‡æœ¬æ¡†çš„èƒŒæ™¯å’Œè¾¹æ¡†æ ·å¼ï¼Œboxstyle='round'æ–‡æœ¬æ¡†ä¸ºåœ†è§’çŸ©å½¢ï¼Œfacecolor='white'èƒŒæ™¯é¢œè‰²ä¸ºç™½è‰²,alpha=0.8é€æ˜åº¦ä¸º0.8
    ax_text.text(0.05,0.5,f'çº¿æ€§å›å½’æ–¹ç¨‹ï¼š\n{equ}\n\nè¯„ä¼°æŒ‡æ ‡ï¼š\n{mse_text}',transform=ax_text.transAxes,verticalalignment='center',bbox=dict(boxstyle='round', facecolor='white', alpha=0.8))
        
    #åˆ©ç”¨æ»‘åŠ¨æ¡ä¸­çš„å€¼æ¥æ›´æ–°test_size
    def update(val):
        #è·å–æ»‘åŠ¨æ¡ä¸­çš„å€¼å¹¶è¿›è¡Œèµ‹å€¼
        test_size=slider.val
        if mode==1:
            #é‡æ–°åˆ©ç”¨test_sizeè·å–æµ‹è¯•æ•°æ®
            model,mse,y_test,y_pred=train_test_model(x,y,test_size=test_size)
            #è·å–çº¿æ€§å›å½’æ–¹ç¨‹çš„æ–‡æœ¬
            equ=f'pl_order = {model.coef_[0]:.3f} * pl_orbsmax + {model.coef_[1]:.3f} * st_mass + {model.intercept_:.3f}'
        elif mode==2:
            #é‡æ–°åˆ©ç”¨test_sizeè·å–æµ‹è¯•æ•°æ®
            intercept,coef,y_test,y_pred,mse=mannual_linear_regression(x,y,test_size=test_size)
            #è·å–çº¿æ€§å›å½’æ–¹ç¨‹çš„æ–‡æœ¬
            equ=f'pl_order = {coef[0]:.3f} * pl_orbsmax + {coef[1]:.3f} * st_mass + {intercept:.3f}'
            
        #è·å–MSEæ–‡æœ¬
        mse_text=f'å‡æ–¹è¯¯å·®ï¼ˆ$MSE$ï¼‰ï¼š{mse:.3f}'

        #æ›´æ–°æ•£ç‚¹å›¾
        scatter.set_offsets(np.c_[y_test,y_pred])

        #æ›´æ–°æ–‡æœ¬æ³¨é‡Š
        #å…ˆæ¸…ç†åŸæœ¬çš„æ•°æ®
        ax_text.clear()
        #å…³é—­åæ ‡è½´
        ax_text.axis('off')
        #æ·»åŠ æ–°çš„æ–‡æœ¬æ³¨é‡Š
        ax_text.text(0.05,0.5,f'çº¿æ€§å›å½’æ–¹ç¨‹ï¼š \n{equ}\n\nè¯„ä¼°æŒ‡æ ‡ï¼š \n{mse_text}',transform=ax_text.transAxes,verticalalignment='center',bbox=dict(boxstyle='round',facecolor='white',alpha=0.8))

        #æ›´æ–°åæ ‡è½´çš„æœ€å¤§å€¼å’Œæœ€å°å€¼
        ax_min=min(y_test.min(),y_pred.min())
        ax_max=max(y_test.max(),y_pred.max())

        #æ›´æ–°ç†æƒ³é¢„æµ‹çº¿
        line.set_data([ax_min,ax_max],[ax_min,ax_max])

        #æ›´æ–°åæ ‡è½´çš„èŒƒå›´
        ax_scatter.set_xlim(ax_min,ax_max)
        ax_scatter.set_ylim(ax_min,ax_max)
        #æ›´æ–°åæ ‡è½´çš„æ¯”ä¾‹
        ax_scatter.set_aspect('equal',adjustable='box')

        #æ›´æ–°å›¾è¡¨ï¼Œè¿™é‡Œåˆ©ç”¨draw_idle()ä¸ç”¨draw()æ˜¯å› ä¸ºdraw_idle()æ›´é€‚åˆäº¤äº’å¼çš„ä¸œè¥¿æ¯”å¦‚æ»‘åŠ¨æ¡
        fig.canvas.draw_idle()

    #åˆ©ç”¨æ»‘åŠ¨æ¡çš„on_changedæ–¹æ³•æ¥æ›´æ–°å›¾è¡¨
    slider.on_changed(update)

    #åœ¨å·¦ä¸Šè§’æ·»åŠ å›¾ä¾‹
    ax_scatter.legend(loc='upper left')

    #è®¾ç½®xè½´æ ‡ç­¾ï¼ˆç¤ºæ„å›¾ä¸­ç»™çš„æ˜¯T_trueï¼‰
    ax_scatter.set_xlabel('T_true')

    #è®¾ç½®yè½´æ ‡ç­¾ï¼ˆç¤ºæ„å›¾ä¸­ç»™çš„æ˜¯T_predï¼‰
    ax_scatter.set_ylabel('T_pred')

    #è®¾ç½®å›¾è¡¨çš„æ ‡é¢˜ï¼ˆç¤ºæ„å›¾ä¸­ç»™çš„æ˜¯true vs. pred Tï¼‰
    ax_scatter.set_title('true vs. pred T')

    ax_scatter.grid(True)

    #æ˜¾ç¤ºå›¾è¡¨
    plt.show()
```
</details>

### å®Œæ•´ä»£ç 
<details>
<summary><strong>ğŸ® åŸºç¡€éƒ¨åˆ†</strong></summary>

---

```python
# -*- coding: utf-8 -*-
import sys
import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error
from sklearn.preprocessing import StandardScaler
from matplotlib.widgets import Slider
import matplotlib.pyplot as plt

# è®¾ç½®matplotlibæ”¯æŒä¸­æ–‡æ˜¾ç¤º
plt.rcParams['font.sans-serif']=['SimHei']#ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾
plt.rcParams['axes.unicode_minus']=False#ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºè´Ÿå·
plt.rcParams['mathtext.fontset'] ='cm'#è®¾ç½® LaTeX å­—ä½“

#åŠ è½½å’Œé¢„å¤„ç†æ•°æ®å‡½æ•°
def load_process_data():
    #ä»expolanet_data.csvæ–‡ä»¶ï¼ˆå½“å‰ç›®å½•ï¼‰ä¸­è¯»å–æ•°æ®
    #ç”±äºè¯»å–çš„æ˜¯DataFrameç±»å‹ï¼Œæ‰€ä»¥è¿™é‡Œç”¨dfç¼©å†™è¡¨ç¤ºè¯»å–çš„æ•°æ®
    #ç”¨pandasåº“æ¥è¯»å–csvæ–‡ä»¶ï¼ˆè¿™é‡Œç®€å†™ä¸ºpdï¼‰
    df=pd.read_csv('exoplanet_data.csv',comment='#')

    #è‡ªå˜é‡ï¼ˆè¾“å…¥å˜é‡ï¼‰xï¼Œå…¶å€¼ä¸ºè½¨é“åŠé•¿è½´aå’Œæ’æ˜ŸæŒ‡ä»¤m
    x=df[['pl_orbsmax','st_mass']]

    #å› å˜é‡ï¼ˆè¾“å‡ºå˜é‡ï¼‰yï¼Œå…¶å€¼ä¸ºè½¨é“å‘¨æœŸ
    y=df['pl_orbper']

    #åˆ é™¤ç¼ºå¤±å€¼ã€‚
    #å› ä¸ºçº¿æ€§å›å½’ç®—æ³•ä¸èƒ½å¤„ç†ç¼ºå¤±å€¼ï¼ˆNaNå’Œnullï¼‰ï¼Œæ‰€ä»¥è¦æ‰‹åŠ¨å¤„ç†ç¼ºå¤±å€¼ï¼Œé˜²æ­¢æ•°æ®ä¸­æœ‰ç¼ºå¤±å€¼å‡ºç°ã€‚
    
    data=pd.concat([x,y],axis=1)#pandasçš„è¿æ¥å‡½æ•°ï¼Œaxis=1è¡¨ç¤ºæ°´å¹³è¿æ¥ï¼Œæ‰€ä»¥è¿™é‡Œå°†xå’Œyæ°´å¹³è¿æ¥èµ·æ¥
    #ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚ï¼š
    """
    åŸå§‹æ•°æ®ï¼š
    x:
       pl_orbsmax  st_mass
    0    1.0        2.0
    1    2.0        NaN#ç¼ºå¤±å€¼
    2    3.0        3.0
    3    4.0        4.0

    y:
    0    10.0
    1    20.0
    2    NaN#ç¼ºå¤±å€¼
    3    40.0

    è¿æ¥åï¼š
       pl_orbsmax  st_mass  pl_orbper
    0    1.0        2.0      10.0
    1    2.0        NaN      20.0    # æœ‰ç¼ºå¤±å€¼
    2    3.0        3.0      NaN     # æœ‰ç¼ºå¤±å€¼
    3    4.0        4.0      40.0
    """

    data=data.dropna()#åˆ é™¤åŒ…å«ç¼ºå¤±å€¼çš„è¡Œ
    #åˆ é™¤ç¼ºå¤±å€¼åï¼Œæ•°æ®å¦‚ä¸‹ï¼š
    """
    pl_orbsmax  st_mass  pl_orbper
    0    1.0        2.0      10.0
    3    4.0        4.0      40.0
    """

    #æ¥ä¸‹æ¥å°±æ˜¯ä»åˆ é™¤åçš„æ•°æ®ä¸­æå–è‡ªå˜é‡xå’Œå› å˜é‡y
    x=data[['pl_orbsmax','st_mass']]
    y=data['pl_orbper']

    #é‚£ä¹ˆå¤„ç†åxå’Œyå°±å˜æˆäº†ï¼š
    """
    x:
   pl_orbsmax  st_mass
    0    1.0        2.0
    3    4.0        4.0

    y:
    0    10.0
    3    40.0
    """

    #è¿”å›å¤„ç†åçš„è‡ªå˜é‡xå’Œå› å˜é‡y
    return x,y

#è®­ç»ƒå’Œæµ‹è¯•æ¨¡å‹å‡½æ•°
def train_test_model(x,y,test_size=0.7):
    #å°†æ•°æ®é›†åˆ’åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†

    #test_sizeè¡¨ç¤ºæœ‰å¤šå°‘çš„æ•°æ®ç”¨æ¥æµ‹è¯•ï¼Œrandom_state=42è¡¨ç¤ºéšæœºç§å­ä¸º42ã€‚éšæœºç§å­çš„è®¾ç½®æ˜¯ä¸ºäº†æ¯æ¬¡è¿è¡Œä»£ç æ—¶ï¼Œåˆ’åˆ†ç»“æœéƒ½ç›¸åŒã€‚
    #è¿™é‡Œé€‰æ‹©éšæœºç§å­ä¸º42æ˜¯å› ä¸º42æ˜¯å®‡å®™çš„ç»ˆæå¥¥ç§˜ï¼ˆï¼‰ã€‚
    x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=test_size,random_state=42)

    #åˆ›å»ºå¹¶è®­ç»ƒçº¿æ€§å›å½’æ¨¡å‹

    #è¿™é‡Œåˆ©ç”¨scikit-learnåº“ä¸­çš„LinearRegressionç±»æ¥åˆ›å»ºçº¿æ€§å›å½’æ¨¡å‹ï¼Œå…¶ä¸­modelå°±æ˜¯LinearRegressionç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚
    #LinearRegressionç±»æ˜¯scikit-learnåº“ä¸­çš„ä¸€ä¸ªçº¿æ€§å›å½’ç±»ï¼Œç”¨äºæ„å»ºç±»ä¼¼äºy=ax_{1}+bx_{2}+cçš„æ–¹ç¨‹ã€‚å…¶ä¸­yä»£è¡¨æˆ‘ä»¬è¦é¢„æµ‹çš„è½¨é“å‘¨æœŸï¼Œx_{1}ä»£è¡¨è½¨é“åŠé•¿è½´ï¼Œx_{2}ä»£è¡¨æ’æ˜Ÿè´¨é‡ã€‚
    model=LinearRegression()

    #åˆ©ç”¨LinearRegressionç±»ä¸­çš„fitæ–¹æ³•è®­ç»ƒæ¨¡å‹
    model.fit(x_train,y_train)

    #ç”¨LinearRegressionç±»ä¸­çš„predictæ–¹æ³•è¿›è¡Œé¢„æµ‹
    y_pred=model.predict(x_test)

    #åˆ©ç”¨mean_squared_errorå‡½æ•°è®¡ç®—å‡æ–¹è¯¯å·®
    mse=mean_squared_error(y_test,y_pred)

    #è¿”å›model,mse,y_test,y_pred
    return model,mse,y_test,y_pred

#æ‰‹åŠ¨å®ç°æœ€å°äºŒä¹˜æ³•å®ç°çº¿æ€§å›å½’ï¼ˆBuild it from scratchåº”è¯¥æ˜¯è¿™ä¸ªæ„æ€å§ï¼ˆï¼‰ï¼‰
def mannual_linear_regression(x,y,test_size=0.7):
    #å°†æ•°æ®é›†åˆ’åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†
    x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=test_size, random_state=42)

    #æ·»åŠ åç½®é¡¹ï¼ˆä¹Ÿå°±æ˜¯æˆªè·é¡¹ï¼‰ï¼ŒæŠŠçŸ©é˜µxçš„æœ€å·¦è¾¹é‚£ä¸€è¡Œå…¨éƒ¨å˜æˆ1ï¼Œä»¥ä¾¿äºå‡ºç°å¸¸æ•°é¡¹
    #æ¯”å¦‚ï¼š
    """
    åŸå§‹æ•°æ®ï¼š
    x:
    |2 3|
    |4 5|
    æ ·æœ¬ï¼š
    x1=2,x2=3
    x1=4,x2=5

    æ·»åŠ åç½®é¡¹åï¼š
    x:
    |1 2 3|
    |1 4 5|

    å°±ä¼šæ˜¯ï¼š
    result:
    |1xc 2xÎ²1 3xÎ²2|
    |1xc 4xÎ²1 5xÎ²2|
    """
    #æ·»åŠ åç½®é¡¹
    x_train_b=np.c_[np.ones(x_train.shape[0]),x_train]

    #è®¡ç®—æœ€å°äºŒä¹˜æ³•çš„è§£æè§£ï¼šÎ²=(X^T*X)^-1*X^T*y
    results=np.linalg.inv(x_train_b.T.dot(x_train_b)).dot(x_train_b.T).dot(y_train)

    #è®¡ç®—æµ‹è¯•é›†çš„é¢„æµ‹å€¼
    x_test_b=np.c_[np.ones(x_test.shape[0]),x_test]
    y_pred=x_test_b.dot(results)

    #è®¡ç®—å‡æ–¹è¯¯å·®
    mse=mean_squared_error(y_test,y_pred)

    #è¿”å›ç»“æœ
    #results[0]æ˜¯æˆªè·é¡¹ï¼Œresults[1:]æ˜¯ç³»æ•°é¡¹
    return results[0],results[1:],y_test,y_pred,mse

#åˆ©ç”¨pltå¯è§†åŒ–é¢„æµ‹ç»“æœ
def visualize_results(x,y,mode=1):
    #åˆ›å»ºå›¾å½¢çª—å£ï¼Œå¹¶å°†å¤§å°è®¾ç½®ä¸º10x6è‹±å¯¸
    fig=plt.figure(figsize=(10,6))

    #åˆ›å»ºGridSpecå¯¹è±¡ï¼Œç”¨äºæ§åˆ¶å­å›¾çš„å¸ƒå±€
    #2,1è¡¨ç¤ºåˆ›å»ºä¸€ä¸ª2è¡Œ1åˆ—çš„å­å›¾
    #height_ratios=[1,4]è¡¨ç¤ºç¬¬ä¸€è¡Œçš„é«˜åº¦ä¸º1ï¼Œç¬¬äºŒè¡Œçš„é«˜åº¦ä¸º4
    #hspace=0.2è¡¨ç¤ºå­å›¾ä¹‹é—´çš„å‚ç›´é—´è·ä¸º0.2
    gs=fig.add_gridspec(2,1,height_ratios=[1,4],hspace=0.2)

    #åœ¨ç½‘æ ¼çš„ç¬¬ä¸€è¡Œåˆ›å»ºä¸€ä¸ªå­å›¾ï¼Œç”¨äºæ˜¾ç¤ºçº¿æ€§å›å½’æ–¹ç¨‹ï¼Œè¯„ä¼°æŒ‡æ ‡
    #gs[0]è¡¨ç¤ºç½‘æ ¼çš„ç¬¬ä¸€è¡Œ
    ax_text=fig.add_subplot(gs[0])

    #åœ¨ç½‘æ ¼çš„ç¬¬äºŒè¡Œåˆ›å»ºä¸€ä¸ªæ•£ç‚¹å›¾å­å›¾
    #gs[1]è¡¨ç¤ºç½‘æ ¼çš„ç¬¬äºŒè¡Œ
    ax_scatter=fig.add_subplot(gs[1])

    #è°ƒæ•´å­å›¾å¸ƒå±€ï¼Œåœ¨åº•éƒ¨ç•™å‡º0.2çš„ç©ºç™½åŒºåŸŸæ”¾ç½®æ»‘åŠ¨æ¡
    plt.subplots_adjust(bottom=0.2)
    
    if mode==1:
        #è·å–train_test_modelçš„è¿”å›å€¼
        model,mse,y_test,y_pred=train_test_model(x,y,test_size=0.7)

        #è·å–çº¿æ€§å›å½’æ–¹ç¨‹çš„æ–‡æœ¬
        equ=f'pl_order = {model.coef_[0]:.3f} * pl_orbsmax + {model.coef_[1]:.3f} * st_mass + {model.intercept_:.3f}'
    elif mode==2:
        #è·å–mannual_linear_regressionçš„è¿”å›å€¼
        intercept,coef,y_test,y_pred,mse=mannual_linear_regression(x,y,test_size=0.7)

        #è·å–çº¿æ€§å›å½’æ–¹ç¨‹çš„æ–‡æœ¬
        equ=f'pl_order = {coef[0]:.3f} * pl_orbsmax + {coef[1]:.3f} * st_mass + {intercept:.3f}'

    #è·å–MSEæ–‡æœ¬
    mse_text=f'å‡æ–¹è¯¯å·®ï¼ˆ$MSE$ï¼‰ï¼š{mse:.3f}'

    #plt.scatter()æ¥ç»˜åˆ¶æ•£ç‚¹å›¾ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯xè½´ï¼ˆè¡¨ç¤ºçœŸå®å€¼ï¼‰ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯yè½´ï¼ˆè¡¨ç¤ºé¢„æµ‹å€¼ï¼‰ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯é€æ˜åº¦
    scatter=ax_scatter.scatter(y_test,y_pred,alpha=0.5,label='pred vs. true')

    #è·å–åæ ‡è½´çš„æœ€å°å€¼å’Œæœ€å¤§å€¼
    ax_min=min(y_test.min(),y_pred.min())
    ax_max=max(y_test.max(),y_pred.max())

    #ç»˜åˆ¶ç†æƒ³çš„é¢„æµ‹çº¿ï¼ˆidealï¼‰ï¼Œä¹Ÿå°±æ˜¯å¯¹è§’çº¿
    #[y_test.min(),y_test.max()]ï¼šxè½´çš„èµ·ç‚¹å’Œç»ˆç‚¹
    #[y_test.min(),y_test.max()]ï¼šyè½´çš„èµ·ç‚¹å’Œç»ˆç‚¹
    #'r--'ï¼šçº¢è‰²è™šçº¿ï¼ˆrä»£è¡¨redçº¢è‰²ï¼Œ--ä»£è¡¨è™šçº¿ï¼‰
    #lw=2ï¼šçº¿å®½ä¸º2
    line,=ax_scatter.plot([ax_min,ax_max],[ax_min,ax_max],'r--',lw=2,label='ideal')

    #è®¾ç½®æ•£ç‚¹å›¾çš„åæ ‡è½´èŒƒå›´ï¼Œä½¿ä¹‹å˜æˆä¸€ä¸ªæ­£æ–¹å½¢
    ax_scatter.set_xlim(ax_min,ax_max)
    ax_scatter.set_ylim(ax_min,ax_max)
    #è®¾ç½®æ•£ç‚¹å›¾çš„åæ ‡è½´æ¯”ä¾‹
    ax_scatter.set_aspect('equal',adjustable='box')
        
    #åˆ›å»ºä¸€ä¸ªæ»‘åŠ¨æ¡ï¼Œç”¨äºæ§åˆ¶æµ‹è¯•é›†çš„æ¯”ä¾‹test_size
    #0.2ï¼šæ»‘åŠ¨æ¡çš„xè½´
    #0.1ï¼šæ»‘åŠ¨æ¡çš„yè½´
    #0.6ï¼šæ»‘åŠ¨æ¡çš„å®½åº¦
    #0.03ï¼šæ»‘åŠ¨æ¡çš„é«˜åº¦
    ax_slider=plt.axes([0.2,0.1,0.6,0.03])
    #åˆ›å»ºä¸€ä¸ªè°ƒèŠ‚èŒƒå›´ä¸º0-1çš„æ»‘åŠ¨æ¡ï¼Œå¹¶ä¸”åˆå§‹å€¼ä¸º0.7
    slider=Slider(ax_slider,'Test Size',0,1,valinit=0.7)

    #æ–‡æœ¬ä¿¡æ¯å…³é—­åæ ‡è½´
    ax_text.axis('off')    

    #æ·»åŠ åˆ°ax_textä¸­
    #0.05ä»£è¡¨æ–‡æœ¬æ¡†å·¦ä¸Šè§’çš„xåæ ‡
    #0.5ä»£è¡¨æ–‡æœ¬æ¡†å·¦ä¸Šè§’çš„yåæ ‡
    #transformæŒ‡å®šåæ ‡ç³»æ˜¯transAxes(ç›¸å¯¹åæ ‡ç³»)ï¼Œåæ ‡èŒƒå›´ä¸º[0,1]
    #verticalalignment='center'è¡¨ç¤ºæ–‡æœ¬å‚ç›´å±…ä¸­äº(0.05,0.5)
    #bbox=dict()è®¾ç½®æ–‡æœ¬æ¡†çš„èƒŒæ™¯å’Œè¾¹æ¡†æ ·å¼ï¼Œboxstyle='round'æ–‡æœ¬æ¡†ä¸ºåœ†è§’çŸ©å½¢ï¼Œfacecolor='white'èƒŒæ™¯é¢œè‰²ä¸ºç™½è‰²,alpha=0.8é€æ˜åº¦ä¸º0.8
    ax_text.text(0.05,0.5,f'çº¿æ€§å›å½’æ–¹ç¨‹ï¼š\n{equ}\n\nè¯„ä¼°æŒ‡æ ‡ï¼š\n{mse_text}',transform=ax_text.transAxes,verticalalignment='center',bbox=dict(boxstyle='round', facecolor='white', alpha=0.8))
        
    #åˆ©ç”¨æ»‘åŠ¨æ¡ä¸­çš„å€¼æ¥æ›´æ–°test_size
    def update(val):
        #è·å–æ»‘åŠ¨æ¡ä¸­çš„å€¼å¹¶è¿›è¡Œèµ‹å€¼
        test_size=slider.val
        if mode==1:
            #é‡æ–°åˆ©ç”¨test_sizeè·å–æµ‹è¯•æ•°æ®
            model,mse,y_test,y_pred=train_test_model(x,y,test_size=test_size)
            #è·å–çº¿æ€§å›å½’æ–¹ç¨‹çš„æ–‡æœ¬
            equ=f'pl_order = {model.coef_[0]:.3f} * pl_orbsmax + {model.coef_[1]:.3f} * st_mass + {model.intercept_:.3f}'
        elif mode==2:
            #é‡æ–°åˆ©ç”¨test_sizeè·å–æµ‹è¯•æ•°æ®
            intercept,coef,y_test,y_pred,mse=mannual_linear_regression(x,y,test_size=test_size)
            #è·å–çº¿æ€§å›å½’æ–¹ç¨‹çš„æ–‡æœ¬
            equ=f'pl_order = {coef[0]:.3f} * pl_orbsmax + {coef[1]:.3f} * st_mass + {intercept:.3f}'
            
        #è·å–MSEæ–‡æœ¬
        mse_text=f'å‡æ–¹è¯¯å·®ï¼ˆ$MSE$ï¼‰ï¼š{mse:.3f}'

        #æ›´æ–°æ•£ç‚¹å›¾
        scatter.set_offsets(np.c_[y_test,y_pred])

        #æ›´æ–°æ–‡æœ¬æ³¨é‡Š
        #å…ˆæ¸…ç†åŸæœ¬çš„æ•°æ®
        ax_text.clear()
        #å…³é—­åæ ‡è½´
        ax_text.axis('off')
        #æ·»åŠ æ–°çš„æ–‡æœ¬æ³¨é‡Š
        ax_text.text(0.05,0.5,f'çº¿æ€§å›å½’æ–¹ç¨‹ï¼š \n{equ}\n\nè¯„ä¼°æŒ‡æ ‡ï¼š \n{mse_text}',transform=ax_text.transAxes,verticalalignment='center',bbox=dict(boxstyle='round',facecolor='white',alpha=0.8))

        #æ›´æ–°åæ ‡è½´çš„æœ€å¤§å€¼å’Œæœ€å°å€¼
        ax_min=min(y_test.min(),y_pred.min())
        ax_max=max(y_test.max(),y_pred.max())

        #æ›´æ–°ç†æƒ³é¢„æµ‹çº¿
        line.set_data([ax_min,ax_max],[ax_min,ax_max])

        #æ›´æ–°åæ ‡è½´çš„èŒƒå›´
        ax_scatter.set_xlim(ax_min,ax_max)
        ax_scatter.set_ylim(ax_min,ax_max)
        #æ›´æ–°åæ ‡è½´çš„æ¯”ä¾‹
        ax_scatter.set_aspect('equal',adjustable='box')

        #æ›´æ–°å›¾è¡¨ï¼Œè¿™é‡Œåˆ©ç”¨draw_idle()ä¸ç”¨draw()æ˜¯å› ä¸ºdraw_idle()æ›´é€‚åˆäº¤äº’å¼çš„ä¸œè¥¿æ¯”å¦‚æ»‘åŠ¨æ¡
        fig.canvas.draw_idle()

    #åˆ©ç”¨æ»‘åŠ¨æ¡çš„on_changedæ–¹æ³•æ¥æ›´æ–°å›¾è¡¨
    slider.on_changed(update)

    #åœ¨å·¦ä¸Šè§’æ·»åŠ å›¾ä¾‹
    ax_scatter.legend(loc='upper left')

    #è®¾ç½®xè½´æ ‡ç­¾ï¼ˆç¤ºæ„å›¾ä¸­ç»™çš„æ˜¯T_trueï¼‰
    ax_scatter.set_xlabel('T_true')

    #è®¾ç½®yè½´æ ‡ç­¾ï¼ˆç¤ºæ„å›¾ä¸­ç»™çš„æ˜¯T_predï¼‰
    ax_scatter.set_ylabel('T_pred')

    #è®¾ç½®å›¾è¡¨çš„æ ‡é¢˜ï¼ˆç¤ºæ„å›¾ä¸­ç»™çš„æ˜¯true vs. pred Tï¼‰
    ax_scatter.set_title('true vs. pred T')

    ax_scatter.grid(True)

    #æ˜¾ç¤ºå›¾è¡¨
    plt.show()

#ä¸»å‡½æ•°
def main(mode=1):
    #åŠ è½½å’Œé¢„å¤„ç†æ•°æ®
    x,y=load_process_data()

    #å¯è§†åŒ–é¢„æµ‹ç»“æœ
    visualize_results(x,y,mode)

#å¦‚æœå½“å‰æ–‡ä»¶æ˜¯ä¸»ç¨‹åºï¼Œè€Œä¸æ˜¯è¢«ç”¨ä½œæ¨¡å—ï¼Œåˆ™æ‰§è¡Œmainå‡½æ•°
if __name__=='__main__':
    if len(sys.argv)>=2:
        main(int(sys.argv[1]))


```
</details>

<details>
<summary><strong>ğŸ›  æ‹“å±•éƒ¨åˆ†</strong></summary>

---

```python
# -*- coding: utf-8 -*-
import sys
import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error
from sklearn.preprocessing import StandardScaler
from matplotlib.widgets import Slider
import matplotlib.pyplot as plt

#è®¾ç½®matplotlibæ”¯æŒä¸­æ–‡æ˜¾ç¤º
plt.rcParams['font.sans-serif']=['SimHei'] #ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾
plt.rcParams['axes.unicode_minus']=False #ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºè´Ÿå·
plt.rcParams['mathtext.fontset']='cm'#è®¾ç½® LaTeX å­—ä½“

#åŠ è½½å’Œé¢„å¤„ç†æ•°æ®å‡½æ•°
def load_process_data():
    #ä»expolanet_data.csvæ–‡ä»¶ï¼ˆå½“å‰ç›®å½•ï¼‰ä¸­è¯»å–æ•°æ®
    #ç”±äºè¯»å–çš„æ˜¯DataFrameç±»å‹ï¼Œæ‰€ä»¥è¿™é‡Œç”¨dfç¼©å†™è¡¨ç¤ºè¯»å–çš„æ•°æ®
    #ç”¨pandasåº“æ¥è¯»å–csvæ–‡ä»¶ï¼ˆè¿™é‡Œç®€å†™ä¸ºpdï¼‰
    df=pd.read_csv('exoplanet_data.csv',comment='#')

    #è‡ªå˜é‡ï¼ˆè¾“å…¥å˜é‡ï¼‰xï¼Œå…¶å€¼ä¸ºè½¨é“åŠé•¿è½´aå’Œæ’æ˜Ÿè´¨é‡m
    x=df[['pl_orbsmax','st_mass']]

    #å› å˜é‡ï¼ˆè¾“å‡ºå˜é‡ï¼‰yï¼Œå…¶å€¼ä¸ºè½¨é“å‘¨æœŸ
    y=df['pl_orbper']

    #åˆ é™¤ç¼ºå¤±å€¼ã€‚
    #å› ä¸ºçº¿æ€§å›å½’ç®—æ³•ä¸èƒ½å¤„ç†ç¼ºå¤±å€¼ï¼ˆNaNå’Œnullï¼‰ï¼Œæ‰€ä»¥è¦æ‰‹åŠ¨å¤„ç†ç¼ºå¤±å€¼ï¼Œé˜²æ­¢æ•°æ®ä¸­æœ‰ç¼ºå¤±å€¼å‡ºç°ã€‚
    
    data=pd.concat([x,y],axis=1) #pandasçš„è¿æ¥å‡½æ•°ï¼Œaxis=1è¡¨ç¤ºæ°´å¹³è¿æ¥ï¼Œæ‰€ä»¥è¿™é‡Œå°†xå’Œyæ°´å¹³è¿æ¥èµ·æ¥
    #ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚ï¼š
    """
    åŸå§‹æ•°æ®ï¼š
    x:
       pl_orbsmax  st_mass
    0    1.0        2.0
    1    2.0        NaN # ç¼ºå¤±å€¼
    2    3.0        3.0
    3    4.0        4.0

    y:
    0    10.0
    1    20.0
    2    NaN # ç¼ºå¤±å€¼
    3    40.0

    è¿æ¥åï¼š
       pl_orbsmax  st_mass  pl_orbper
    0    1.0        2.0      10.0
    1    2.0        NaN      20.0    # æœ‰ç¼ºå¤±å€¼
    2    3.0        3.0      NaN     # æœ‰ç¼ºå¤±å€¼
    3    4.0        4.0      40.0
    """

    data=data.dropna()#åˆ é™¤åŒ…å«ç¼ºå¤±å€¼çš„è¡Œ
    #åˆ é™¤ç¼ºå¤±å€¼åï¼Œæ•°æ®å¦‚ä¸‹ï¼š
    """
    pl_orbsmax  st_mass  pl_orbper
    0    1.0        2.0      10.0
    3    4.0        4.0      40.0
    """

    #æ¥ä¸‹æ¥å°±æ˜¯ä»åˆ é™¤åçš„æ•°æ®ä¸­æå–è‡ªå˜é‡xå’Œå› å˜é‡y
    x=data[['pl_orbsmax','st_mass']]
    y=data['pl_orbper']

    #é‚£ä¹ˆå¤„ç†åxå’Œyå°±å˜æˆäº†ï¼š
    """
    x:
   pl_orbsmax  st_mass
    0    1.0        2.0
    3    4.0        4.0

    y:
    0    10.0
    3    40.0
    """

    #extend.pyæ‹“å±•éƒ¨åˆ†æ–°åŠ ï¼šå¯¹æ•°å˜æ¢ï¼Œä¸”å¯ä»¥å‡å°æ•°æ®ä¹‹é—´çš„é—´éš™
    x=np.log(abs(x))#åŠ ç»å¯¹å€¼å¯ä»¥é¿å…è´Ÿå€¼
    y=np.log(abs(y))

    #è¿”å›å¤„ç†åçš„è‡ªå˜é‡xå’Œå› å˜é‡y
    return x,y

#è®­ç»ƒå’Œæµ‹è¯•æ¨¡å‹å‡½æ•°
def train_test_model(x,y,test_size=0.7):
    #å°†æ•°æ®é›†åˆ’åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†

    #test_sizeè¡¨ç¤ºæœ‰å¤šå°‘çš„æ•°æ®ç”¨æ¥æµ‹è¯•ï¼Œrandom_state=42è¡¨ç¤ºéšæœºç§å­ä¸º42ã€‚éšæœºç§å­çš„è®¾ç½®æ˜¯ä¸ºäº†æ¯æ¬¡è¿è¡Œä»£ç æ—¶ï¼Œåˆ’åˆ†ç»“æœéƒ½ç›¸åŒã€‚
    #è¿™é‡Œé€‰æ‹©éšæœºç§å­ä¸º42æ˜¯å› ä¸º42æ˜¯å®‡å®™çš„ç»ˆæå¥¥ç§˜ï¼ˆï¼‰ã€‚
    x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=test_size,random_state=42)

    #åˆ›å»ºå¹¶è®­ç»ƒçº¿æ€§å›å½’æ¨¡å‹

    #è¿™é‡Œåˆ©ç”¨scikit-learnåº“ä¸­çš„LinearRegressionç±»æ¥åˆ›å»ºçº¿æ€§å›å½’æ¨¡å‹ï¼Œå…¶ä¸­modelå°±æ˜¯LinearRegressionç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚
    #LinearRegressionç±»æ˜¯scikit-learnåº“ä¸­çš„ä¸€ä¸ªçº¿æ€§å›å½’ç±»ï¼Œç”¨äºæ„å»ºç±»ä¼¼äºy=ax_{1}+bx_{2}+cçš„æ–¹ç¨‹ã€‚å…¶ä¸­yä»£è¡¨æˆ‘ä»¬è¦é¢„æµ‹çš„è½¨é“å‘¨æœŸï¼Œx_{1}ä»£è¡¨è½¨é“åŠé•¿è½´ï¼Œx_{2}ä»£è¡¨æ’æ˜Ÿè´¨é‡ã€‚
    model=LinearRegression()

    #åˆ©ç”¨LinearRegressionç±»ä¸­çš„fitæ–¹æ³•è®­ç»ƒæ¨¡å‹
    model.fit(x_train,y_train)

    #ç”¨LinearRegressionç±»ä¸­çš„predictæ–¹æ³•è¿›è¡Œé¢„æµ‹
    y_pred=model.predict(x_test)

    #extend.pyæ‹“å±•éƒ¨åˆ†æ–°åŠ ï¼šè®¡ç®—RÂ²åˆ†æ•°
    r2=model.score(x_test,y_test)

    #åˆ©ç”¨mean_squared_errorå‡½æ•°è®¡ç®—å‡æ–¹è¯¯å·®
    mse=mean_squared_error(y_test,y_pred)

    #è¿”å›model,mse,r2,y_test,y_pred
    return model,mse,r2,y_test,y_pred

#æ‰‹åŠ¨å®ç°æœ€å°äºŒä¹˜æ³•å®ç°çº¿æ€§å›å½’ï¼ˆBuild it from scratchåº”è¯¥æ˜¯è¿™ä¸ªæ„æ€å§ï¼ˆï¼‰ï¼‰
def mannual_linear_regression(x,y,test_size=0.7):
    #å°†æ•°æ®é›†åˆ’åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†
    x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=test_size, random_state=42)

    #æ·»åŠ åç½®é¡¹ï¼ˆä¹Ÿå°±æ˜¯æˆªè·é¡¹ï¼‰ï¼ŒæŠŠçŸ©é˜µxçš„æœ€å·¦è¾¹é‚£ä¸€è¡Œå…¨éƒ¨å˜æˆ1ï¼Œä»¥ä¾¿äºå‡ºç°å¸¸æ•°é¡¹
    #æ¯”å¦‚ï¼š
    """
    åŸå§‹æ•°æ®ï¼š
    x:
    |2 3|
    |4 5|
    æ ·æœ¬ï¼š
    x1=2,x2=3
    x1=4,x2=5

    æ·»åŠ åç½®é¡¹åï¼š
    x:
    |1 2 3|
    |1 4 5|

    å°±ä¼šæ˜¯ï¼š
    result:
    |1xc 2xÎ²1 3xÎ²2|
    |1xc 4xÎ²1 5xÎ²2|
    """
    #æ·»åŠ åç½®é¡¹
    x_train_b=np.c_[np.ones(x_train.shape[0]),x_train]

    #è®¡ç®—æœ€å°äºŒä¹˜æ³•çš„è§£æè§£ï¼šÎ²=(X^T*X)^-1*X^T*y
    results=np.linalg.inv(x_train_b.T.dot(x_train_b)).dot(x_train_b.T).dot(y_train)

    #è®¡ç®—æµ‹è¯•é›†çš„é¢„æµ‹å€¼
    x_test_b=np.c_[np.ones(x_test.shape[0]),x_test]
    y_pred=x_test_b.dot(results)

    #è®¡ç®—å‡æ–¹è¯¯å·®
    mse=mean_squared_error(y_test,y_pred)

    #extend.pyæ‹“å±•éƒ¨åˆ†æ–°åŠ ï¼šè®¡ç®—RÂ²åˆ†æ•°
    #RÂ²=1-(æ®‹å·®å¹³æ–¹å’Œ/æ€»å¹³æ–¹å’Œ)
    #æ®‹å·®å¹³æ–¹å’Œ=sum((y_test-y_pred)**2)
    l=np.sum((y_test-y_pred)**2)
    #æ€»å¹³æ–¹å’Œ=sum((y_test-y_test.mean())**2)
    r=np.sum((y_test-y_test.mean())**2)
    r2=1-(l/r)

    #è¿”å›ç»“æœ
    #results[0]æ˜¯æˆªè·é¡¹ï¼Œresults[1:]æ˜¯ç³»æ•°é¡¹
    return results[0],results[1:],y_test,y_pred,mse,r2

#åˆ©ç”¨pltå¯è§†åŒ–é¢„æµ‹ç»“æœ
def visualize_results(x,y,mode=1):
    #åˆ›å»ºå›¾å½¢çª—å£ï¼Œå¹¶å°†å¤§å°è®¾ç½®ä¸º10x6è‹±å¯¸
    fig=plt.figure(figsize=(10,6))

    #åˆ›å»ºGridSpecå¯¹è±¡ï¼Œç”¨äºæ§åˆ¶å­å›¾çš„å¸ƒå±€
    #2,1è¡¨ç¤ºåˆ›å»ºä¸€ä¸ª2è¡Œ1åˆ—çš„å­å›¾
    #height_ratios=[1,4]è¡¨ç¤ºç¬¬ä¸€è¡Œçš„é«˜åº¦ä¸º1ï¼Œç¬¬äºŒè¡Œçš„é«˜åº¦ä¸º4
    #hspace=0.2è¡¨ç¤ºå­å›¾ä¹‹é—´çš„å‚ç›´é—´è·ä¸º0.2
    gs=fig.add_gridspec(2,1,height_ratios=[1,4],hspace=0.2)

    #åœ¨ç½‘æ ¼çš„ç¬¬ä¸€è¡Œåˆ›å»ºä¸€ä¸ªå­å›¾ï¼Œç”¨äºæ˜¾ç¤ºçº¿æ€§å›å½’æ–¹ç¨‹ï¼Œè¯„ä¼°æŒ‡æ ‡
    #gs[0]è¡¨ç¤ºç½‘æ ¼çš„ç¬¬ä¸€è¡Œ
    ax_text=fig.add_subplot(gs[0])

    #åœ¨ç½‘æ ¼çš„ç¬¬äºŒè¡Œåˆ›å»ºä¸€ä¸ªæ•£ç‚¹å›¾å­å›¾
    #gs[1]è¡¨ç¤ºç½‘æ ¼çš„ç¬¬äºŒè¡Œ
    ax_scatter=fig.add_subplot(gs[1])

    #è°ƒæ•´å­å›¾å¸ƒå±€ï¼Œåœ¨åº•éƒ¨ç•™å‡º0.2çš„ç©ºç™½åŒºåŸŸæ”¾ç½®æ»‘åŠ¨æ¡
    plt.subplots_adjust(bottom=0.2)
    
    if mode==1:
        #è·å–train_test_modelçš„è¿”å›å€¼
        model,mse,r2,y_test,y_pred=train_test_model(x,y,test_size=0.7)

        #è·å–çº¿æ€§å›å½’æ–¹ç¨‹çš„æ–‡æœ¬
        equ=f'pl_order = {model.coef_[0]:.3f} * pl_orbsmax + {model.coef_[1]:.3f} * st_mass + {model.intercept_:.3f}'
    elif mode==2:
        #è·å–mannual_linear_regressionçš„è¿”å›å€¼
        intercept,coef,y_test,y_pred,mse,r2=mannual_linear_regression(x,y,test_size=0.7)

        #è·å–çº¿æ€§å›å½’æ–¹ç¨‹çš„æ–‡æœ¬
        equ=f'pl_order = {coef[0]:.3f} * pl_orbsmax + {coef[1]:.3f} * st_mass + {intercept:.3f}'

    #è·å–MSEæ–‡æœ¬
    mse_text=f'å‡æ–¹è¯¯å·®ï¼ˆ$MSE$ï¼‰ï¼š{mse:.3f}'

    #è·å–RÂ²æ–‡æœ¬
    r2_text=f'å†³å®šç³»æ•°ï¼ˆ$R^2$ï¼‰ï¼š{r2:.3f}'

    #è®°å½•è¯¯å·®æ–‡æœ¬
    error_text=f'{mse_text}\n{r2_text}'

    #plt.scatter()æ¥ç»˜åˆ¶æ•£ç‚¹å›¾ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯xè½´ï¼ˆè¡¨ç¤ºçœŸå®å€¼ï¼‰ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯yè½´ï¼ˆè¡¨ç¤ºé¢„æµ‹å€¼ï¼‰ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯é€æ˜åº¦
    scatter=ax_scatter.scatter(y_test,y_pred,alpha=0.5,label='pred vs. true')

    #è·å–åæ ‡è½´çš„æœ€å°å€¼å’Œæœ€å¤§å€¼
    ax_min=min(y_test.min(),y_pred.min())
    ax_max=max(y_test.max(),y_pred.max())

    #ç»˜åˆ¶ç†æƒ³çš„é¢„æµ‹çº¿ï¼ˆidealï¼‰ï¼Œä¹Ÿå°±æ˜¯å¯¹è§’çº¿
    #[y_test.min(),y_test.max()]ï¼šxè½´çš„èµ·ç‚¹å’Œç»ˆç‚¹
    #[y_test.min(),y_test.max()]ï¼šyè½´çš„èµ·ç‚¹å’Œç»ˆç‚¹
    #'r--'ï¼šçº¢è‰²è™šçº¿ï¼ˆrä»£è¡¨redçº¢è‰²ï¼Œ--ä»£è¡¨è™šçº¿ï¼‰
    #lw=2ï¼šçº¿å®½ä¸º2
    line,=ax_scatter.plot([ax_min,ax_max],[ax_min,ax_max],'r--',lw=2,label='ideal')

    #è®¾ç½®æ•£ç‚¹å›¾çš„åæ ‡è½´èŒƒå›´ï¼Œä½¿ä¹‹å˜æˆä¸€ä¸ªæ­£æ–¹å½¢
    ax_scatter.set_xlim(ax_min,ax_max)
    ax_scatter.set_ylim(ax_min,ax_max)
    #è®¾ç½®æ•£ç‚¹å›¾çš„åæ ‡è½´æ¯”ä¾‹
    ax_scatter.set_aspect('equal',adjustable='box')
        
    #åˆ›å»ºä¸€ä¸ªæ»‘åŠ¨æ¡ï¼Œç”¨äºæ§åˆ¶æµ‹è¯•é›†çš„æ¯”ä¾‹test_size
    #0.2ï¼šæ»‘åŠ¨æ¡çš„xè½´
    #0.1ï¼šæ»‘åŠ¨æ¡çš„yè½´
    #0.6ï¼šæ»‘åŠ¨æ¡çš„å®½åº¦
    #0.03ï¼šæ»‘åŠ¨æ¡çš„é«˜åº¦
    ax_slider=plt.axes([0.2,0.1,0.6,0.03])
    #åˆ›å»ºä¸€ä¸ªè°ƒèŠ‚èŒƒå›´ä¸º0-1çš„æ»‘åŠ¨æ¡ï¼Œå¹¶ä¸”åˆå§‹å€¼ä¸º0.7
    slider=Slider(ax_slider,'Test Size',0,1,valinit=0.7)

    #æ–‡æœ¬ä¿¡æ¯å…³é—­åæ ‡è½´
    ax_text.axis('off')    

    #æ·»åŠ åˆ°ax_textä¸­
    #0.05ä»£è¡¨æ–‡æœ¬æ¡†å·¦ä¸Šè§’çš„xåæ ‡
    #0.5ä»£è¡¨æ–‡æœ¬æ¡†å·¦ä¸Šè§’çš„yåæ ‡
    #transformæŒ‡å®šåæ ‡ç³»æ˜¯transAxes(ç›¸å¯¹åæ ‡ç³»)ï¼Œåæ ‡èŒƒå›´ä¸º[0,1]
    #verticalalignment='center'è¡¨ç¤ºæ–‡æœ¬å‚ç›´å±…ä¸­äº(0.05,0.5)
    #bbox=dict()è®¾ç½®æ–‡æœ¬æ¡†çš„èƒŒæ™¯å’Œè¾¹æ¡†æ ·å¼ï¼Œboxstyle='round'æ–‡æœ¬æ¡†ä¸ºåœ†è§’çŸ©å½¢ï¼Œfacecolor='white'èƒŒæ™¯é¢œè‰²ä¸ºç™½è‰²,alpha=0.8é€æ˜åº¦ä¸º0.8
    ax_text.text(0.05,0.5,f'çº¿æ€§å›å½’æ–¹ç¨‹ï¼š\n{equ}\n\nè¯„ä¼°æŒ‡æ ‡ï¼š\n{error_text}',transform=ax_text.transAxes,verticalalignment='center',bbox=dict(boxstyle='round', facecolor='white', alpha=0.8))
        
    #åˆ©ç”¨æ»‘åŠ¨æ¡ä¸­çš„å€¼æ¥æ›´æ–°test_size
    def update(val):
        #è·å–æ»‘åŠ¨æ¡ä¸­çš„å€¼å¹¶è¿›è¡Œèµ‹å€¼
        test_size=slider.val
        if mode==1:
            #é‡æ–°åˆ©ç”¨test_sizeè·å–æµ‹è¯•æ•°æ®
            model,mse,r2,y_test,y_pred=train_test_model(x,y,test_size=test_size)
            #è·å–çº¿æ€§å›å½’æ–¹ç¨‹çš„æ–‡æœ¬
            equ=f'pl_order = {model.coef_[0]:.3f} * pl_orbsmax + {model.coef_[1]:.3f} * st_mass + {model.intercept_:.3f}'
        elif mode==2:
            #é‡æ–°åˆ©ç”¨test_sizeè·å–æµ‹è¯•æ•°æ®
            intercept,coef,y_test,y_pred,mse=mannual_linear_regression(x,y,test_size=test_size)
            #è·å–çº¿æ€§å›å½’æ–¹ç¨‹çš„æ–‡æœ¬
            equ=f'pl_order = {coef[0]:.3f} * pl_orbsmax + {coef[1]:.3f} * st_mass + {intercept:.3f}'
            
        #è·å–MSEæ–‡æœ¬
        mse_text=f'å‡æ–¹è¯¯å·®ï¼ˆ$MSE$ï¼‰ï¼š{mse:.3f}'

        #è·å–RÂ²æ–‡æœ¬
        r2_text=f'å†³å®šç³»æ•°ï¼ˆ$R^2$ï¼‰ï¼š{r2:.3f}'

        #è®°å½•è¯¯å·®æ–‡æœ¬
        error_text=f'{mse_text}\n{r2_text}'

        #æ›´æ–°æ•£ç‚¹å›¾
        scatter.set_offsets(np.c_[y_test,y_pred])

        #æ›´æ–°æ–‡æœ¬æ³¨é‡Š
        #å…ˆæ¸…ç†åŸæœ¬çš„æ•°æ®
        ax_text.clear()
        #å…³é—­åæ ‡è½´
        ax_text.axis('off')
        #æ·»åŠ æ–°çš„æ–‡æœ¬æ³¨é‡Š
        ax_text.text(0.05,0.5,f'çº¿æ€§å›å½’æ–¹ç¨‹ï¼š \n{equ}\n\nè¯„ä¼°æŒ‡æ ‡ï¼š \n{error_text}',transform=ax_text.transAxes,verticalalignment='center',bbox=dict(boxstyle='round',facecolor='white',alpha=0.8))

        #æ›´æ–°åæ ‡è½´çš„æœ€å¤§å€¼å’Œæœ€å°å€¼
        ax_min=min(y_test.min(),y_pred.min())
        ax_max=max(y_test.max(),y_pred.max())

        #æ›´æ–°ç†æƒ³é¢„æµ‹çº¿
        line.set_data([ax_min,ax_max],[ax_min,ax_max])

        #æ›´æ–°åæ ‡è½´çš„èŒƒå›´
        ax_scatter.set_xlim(ax_min,ax_max)
        ax_scatter.set_ylim(ax_min,ax_max)
        #æ›´æ–°åæ ‡è½´çš„æ¯”ä¾‹
        ax_scatter.set_aspect('equal',adjustable='box')

        #æ›´æ–°å›¾è¡¨ï¼Œè¿™é‡Œåˆ©ç”¨draw_idle()ä¸ç”¨draw()æ˜¯å› ä¸ºdraw_idle()æ›´é€‚åˆäº¤äº’å¼çš„ä¸œè¥¿æ¯”å¦‚æ»‘åŠ¨æ¡
        fig.canvas.draw_idle()

    #åˆ©ç”¨æ»‘åŠ¨æ¡çš„on_changedæ–¹æ³•æ¥æ›´æ–°å›¾è¡¨
    slider.on_changed(update)

    #åœ¨å·¦ä¸Šè§’æ·»åŠ å›¾ä¾‹
    ax_scatter.legend(loc='upper left')

    #è®¾ç½®xè½´æ ‡ç­¾ï¼ˆç¤ºæ„å›¾ä¸­ç»™çš„æ˜¯T_trueï¼‰
    ax_scatter.set_xlabel('T_true')

    #è®¾ç½®yè½´æ ‡ç­¾ï¼ˆç¤ºæ„å›¾ä¸­ç»™çš„æ˜¯T_predï¼‰
    ax_scatter.set_ylabel('T_pred')

    #è®¾ç½®å›¾è¡¨çš„æ ‡é¢˜ï¼ˆç¤ºæ„å›¾ä¸­ç»™çš„æ˜¯true vs. pred Tï¼‰
    ax_scatter.set_title('true vs. pred T')

    ax_scatter.grid(True)

    #æ˜¾ç¤ºå›¾è¡¨
    plt.show()

#ä¸»å‡½æ•°
def main(mode=1):
    #åŠ è½½å’Œé¢„å¤„ç†æ•°æ®
    x,y=load_process_data()

    #å¯è§†åŒ–é¢„æµ‹ç»“æœ
    visualize_results(x,y,mode)

#å¦‚æœå½“å‰æ–‡ä»¶æ˜¯ä¸»ç¨‹åºï¼Œè€Œä¸æ˜¯è¢«ç”¨ä½œæ¨¡å—ï¼Œåˆ™æ‰§è¡Œmainå‡½æ•°
if __name__=='__main__':
    if len(sys.argv)>=2:
        main(int(sys.argv[1]))
```
</details>

### è¿è¡Œæˆªå›¾

<details>
<summary><strong>ğŸ® åŸºç¡€éƒ¨åˆ†</strong></summary>

---

- **base_sklearn.py**
    ![image1.png](image1.png)
  
- **base_mannual.py**
    ![image2.png](image2.png)
  
</details>

<details>
<summary><strong>ğŸ›  æ‹“å±•éƒ¨åˆ†</strong></summary>

---
  
- **extend_sklearn.py**
    ![image3.png](image3.png)
  
- **extend_mannual.py**
    ![image4.png](image4.png)
  
</details>

### æ€»ç»“

<details>
<summary><strong>ğŸ‰ æ€»ç»“</strong></summary>

---

ç¡®å®æ˜¯å…³äºæœºå™¨å­¦ä¹ ï¼Œçº¿æ€§å›å½’æ¨¡å‹çš„å¥½é¢˜ï¼Œä»ä¸­ä¹Ÿå­¦åˆ°äº†å¾ˆå¤šæ–°çš„åº“ï¼Œæ¯”å¦‚scikit-learnï¼Œpandasï¼Œmatplotlibï¼Œnumpyç­‰ã€‚è€Œä¸”ä»¥å‰ä¹Ÿåªæ˜¯åœç•™åœ¨ç†è®ºä¸Šï¼Œè¿™æ¬¡æ˜¯é€šè¿‡ä»£ç å®è·µäº†ä¸€ä¸‹ï¼Œå°è±¡æ›´æ·±äº†
</details>
